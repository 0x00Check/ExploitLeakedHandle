#pragma once
#include "ElhInit.h"

class ElhExploit {
    ElhInit::HANDLE_OBJ targetHandle;
    HANDLE targetProcess;
    HANDLE dupedHandle;
    DWORD grantedAccess;
public:
    ElhExploit(std::vector<ElhInit::HANDLE_OBJ>& interestingHandles);
    ~ElhExploit();
    bool selectionValid();
    bool exploitHandle();
private:
    ElhInit::HANDLE_OBJ selectHandleToExploit(std::vector<ElhInit::HANDLE_OBJ>& interestingHandles);
    void exploitProcessHandle(bool& endResult);
    void exploitThreadHandle(bool& endResult);
    void exploitFileHandle(bool& endResult);
};