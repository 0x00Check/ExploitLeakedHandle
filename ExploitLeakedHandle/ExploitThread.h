#pragma once
#include "ntdll.h"
#pragma comment(lib, "ntdll.lib")

class ExploitThread {
public:
    static bool exploitAllAccess(HANDLE& hTgt);
    static bool exploitDirectImpersonation(HANDLE& hTgt);
    static bool exploitSetContext(HANDLE& hTgt);
private:
    static void allocProcessInformationSize(PSYSTEM_PROCESS_INFORMATION& pSystemProcessInfo, ULONG ulSystemInfoLength);
    static void getSystemProcessInformation(PSYSTEM_PROCESS_INFORMATION& pSystemProcessInfo);
    static bool isThreadReady(PSYSTEM_PROCESS_INFORMATION pProcInfo, DWORD dwTID);
};