#pragma once
#include <string>
#include "ntdll.h"
#include <Psapi.h>
#include <TlHelp32.h>

#pragma comment(lib, "ntdll.lib")

HANDLE openProcessID(USHORT& uPID, DWORD dwDesiredAccess);
std::wstring getProcessName(HANDLE& hProcess);
std::wstring getProcessName(USHORT& uPID);
std::wstring getObjectName(HANDLE handle);
DWORD getProcessIntegrity(HANDLE& hProcess);
DWORD getParentProcessID(HANDLE hProcess);
uintptr_t getModuleBaseAddress(const wchar_t* moduleName);
HANDLE duplicateHandle(SYSTEM_HANDLE_TABLE_ENTRY_INFO& handleInfo, HANDLE& hProcess);
bool accessContainsRights(DWORD dwGrantedAccess, DWORD dwAccessRights);