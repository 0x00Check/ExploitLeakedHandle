#pragma once
#include "ElhInit.h"
#include <iostream>

class ElhExploit {
	HANDLE_OBJ targetHandle;
	HANDLE targetProcess;
	HANDLE dupedHandle;
	DWORD grantedAccess;
public:
	ElhExploit(std::vector<HANDLE_OBJ> &interestingHandles);
	~ElhExploit();
	bool selectionValid();
	bool exploitHandle();
private:
	HANDLE_OBJ selectHandleToExploit(std::vector<HANDLE_OBJ> &interestingHandles);
	void exploitProcessHandle(bool &endResult);
	void exploitThreadHandle(bool &endResult);
	void exploitFileHandle(bool &endResult);
};